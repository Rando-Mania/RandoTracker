<!DOCTYPE html>
<html>
<head profile="http://www.w3.org/2005/10/profile">
	<meta charset="utf-8">
	<title>Chaos Rush Tracker</title>
	<link rel="stylesheet" type="text/css" href="../content/tracker.css">
	<link rel="stylesheet" type="text/css" href="four.css">
	<link rel="shortcut icon" type="image/x-icon" href="favicon.ico">
	<link rel="icon item" type="image/x-icon" href="favicon.ico">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link href="https://fonts.googleapis.com/css?family=Raleway" rel="stylesheet">
</head>
<body>
	<img src="images/chaos_rush_layout_nopointsboxes.png" style="position: absolute; top: 0; left: 0; width: 1280px; height: 720px"/>

    <div data-property="p1-points" class="freetext-record nowrap" style="top: 284px; left: 450px;"></div>
    <div data-property="p2-points" class="freetext-record nowrap" style="top: 284px; left: 785px;"></div>
    <div data-property="p3-points" class="freetext-record nowrap" style="top: 409px; left: 450px;"></div>
    <div data-property="p4-points" class="freetext-record nowrap" style="top: 409px; left: 785px;"></div>

<div class="name-final-wrapper" style="top: 341px; left: 37px; position: absolute;">
	<div class="name-final-contain">
		<div id="player_name_1" data-scale-to-fit="true" class="player-name nowrap" style="position: relative;"></div>
		<div id="player_final_1" class="player-final" style="position: relative;"></div>
	</div>
</div>

<div class="name-final-wrapper" style="top: 340px; left: 833px; position: absolute;">
	<div class="name-final-contain">
		<div id="player_name_2" data-scale-to-fit="true" class="player-name nowrap" style="position: relative;"></div>
		<div id="player_final_2" class="player-final" style="position: relative;"></div>
	</div>
</div>

<div class="name-final-wrapper" style="top: 350px; left: 271px; position: absolute;">
	<div class="name-final-contain">
		<div id="player_name_3" data-scale-to-fit="true" class="player-name nowrap" style="position: relative;"></div>
		<div id="player_final_3" class="player-final" style="position: relative;"></div>
	</div>
</div>

<div class="name-final-wrapper" style="top: 350px; left: 1066px; position: absolute;">
	<div class="name-final-contain">
		<div id="player_name_4" data-scale-to-fit="true" class="player-name nowrap" style="position: relative;"></div>
		<div id="player_final_4" class="player-final" style="position: relative;"></div>
	</div>
</div>

	<div id="player_speaker_1" class="player-speaker hidden" style="top: 228px; left: 454px;"><img src="images/speaker.png"/></div>
	<div id="player_speaker_2" class="player-speaker hidden" style="top: 228px; left: 787px;"><img src="images/speaker.png"/></div>
	<div id="player_speaker_3" class="player-speaker hidden" style="top: 507px; left: 452px;"><img src="images/speaker.png"/></div>
	<div id="player_speaker_4" class="player-speaker hidden" style="top: 507px; left: 787px;"><img src="images/speaker.png"/></div>
	<div id="player_final_2" class="player-final" style="top: 361px; left: 837px;"></div>
	<div id="player_final_3" class="player-final" style="top: 348px; left: 274px;"></div>
	<div id="player_final_4" class="player-final" style="top: 348px; left: 1069px;"></div>

	<div id="commentators" data-scale-to-fit="true" class="nowrap" style="top: 560px; left: 460px"></div>
	<div id="timer" style="top: 232px; left: 561px"></div>

	<div id="class_tracker" style="top: 635px; left: 580px">
        <span class="class-icon" data-property="class_1" data-open-dialog="#dialog_class" data-image="images/open2.png"></span>
        <span class="class-icon" data-property="class_2" data-open-dialog="#dialog_class" data-image="images/open2.png"></span>
        <span class="class-icon" data-property="class_3" data-open-dialog="#dialog_class" data-image="images/open2.png"></span>
    </div>

	<fieldset id="dialog_class" class="dialog" style="width: 140px">
        <span class="dialog-icon" data-set-prop="true" data-image="images/open2.png" data-value="images/open2.png"></span>
        <span class="dialog-icon" data-set-prop="true" data-image="images/fighter.png" data-value="images/fighter.png"></span>
        <span class="dialog-icon" data-set-prop="true" data-image="images/thief.png" data-value="images/thief.png"></span>
        <span class="dialog-icon" data-set-prop="true" data-image="images/blackbelt.png" data-value="images/blackbelt.png"></span>
        <span class="dialog-icon" data-set-prop="true" data-image="images/redmage.png" data-value="images/redmage.png"></span>
        <span class="dialog-icon" data-set-prop="true" data-image="images/whitemage.png" data-value="images/whitemage.png"></span>
        <span class="dialog-icon" data-set-prop="true" data-image="images/blackmage.png" data-value="images/blackmage.png"></span>
        <span class="dialog-icon" data-set-prop="true" data-image="images/none.png" data-value="images/none.png"></span>
    </fieldset>

	<script defer src="/__/firebase/5.2.0/firebase-app.js"></script>
	<script defer src="/__/firebase/5.2.0/firebase-auth.js"></script>
	<script defer src="/__/firebase/5.2.0/firebase-database.js"></script>
	<script defer src="/__/firebase/init.js"></script>
	<script defer src="../script/tracker.js"></script>
	<script defer type="text/javascript">
		(function(Tracker) {
			Tracker.loaded = function() {
                Tracker.init({
                    playerCount: 4,
                    freetext: [{
                        label: "P1 Points",
                        property: "p1-points",
                    }, {
                        label: "P2 Points",
                        property: "p2-points"
                    }, {
                        label: "P3 Points",
                        property: "p3-points"
                    }, {
                        label: "P4 Points",
                        property: "p4-points"
                    }]
                });

                var playerFinals = document.querySelectorAll(".player-final");

                // Attach listeners to add/remove fit-final-time as necessary
                var checkForEmpty = function() {
                	playerFinals.forEach(function(element) {
						var length = element.textContent.trim().length;
						var parent = element.closest(".name-final-contain");

						if (length == 0) {
							// Remove class
							parent.classList.remove("fit-final-time");
						} else {
							// Add class
							parent.classList.add("fit-final-time");
						}
                	});
				};

				var observer = new MutationObserver(function(mutations) {
					checkForEmpty();
				});

				var config = {characterData: true, subtree: true, childList: true};

				playerFinals.forEach((target) => {
					observer.observe(target, config);
				});

				setTimeout(checkForEmpty, 1);
			}
		})(window.Tracker = window.Tracker || {});
	</script>
</body>
</html>