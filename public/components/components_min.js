(function(){function t(){return"tr-ds-stages"}function e(t){let e=t.closest("tr-ds-stage")||t;return Number(e.getAttribute("stage"))}document.currentScript.ownerDocument;(function(){class t extends HTMLElement{constructor(){super()}get tracking(){return this.getAttribute("tracking")}connectedCallback(){const t=this,e=document.createElement("button");t.tracking?e.innerHTML="Reset Tracking":e.innerHTML="Reset Room",e.onclick=function(){var e=window.confirm("Are you sure you want to reset the room?");e&&Tracker.resetRoom(t.tracking)},this.appendChild(e)}}customElements.define("tr-button-reset",t)})(),function(){class t extends HTMLElement{constructor(){super(),this.isRunning=!1,this.elapsed=0,this.serverTime=0}get property(){return Tracker.getPropertyAttribute(this)}connectedCallback(){const t=this,e=document.createElement("button"),r=document.createElement("button"),n=document.createElement("button"),s=document.createElement("span");var i=!1;e.innerHTML="Start",r.innerHTML="Reset",n.innerHTML="Pause",s.innerHTML="Click Reset again to confirm.";var a=function(){t.isRunning?(e.style.display="none",n.style.display="initial"):(e.style.display="initial",n.style.display="none"),s.style.display=i?"initial":"none"};e.classList.add("start"),r.classList.add("reset"),n.classList.add("pause"),s.classList.add("reset-confirm"),e.onclick=function(){var e=document.querySelector("tr-input-timer[property='"+t.property+"']"),r=t.elapsed;e&&(r=Tracker.timerToTimeValue(e.value)),i=!1,Tracker.setActiveTimer(t.property),Tracker.updateLayout(t.property,{elapsed:r,isRunning:!0,serverTime:firebase.database.ServerValue.TIMESTAMP})},r.onclick=function(){i?(Tracker.updateLayout(t.property,{elapsed:0,isRunning:!1,serverTime:firebase.database.ServerValue.TIMESTAMP}),i=!1):(i=!0,a())},n.onclick=function(){i=!1,Tracker.getServerTime().then(function(e){Tracker.updateLayout(t.property,{elapsed:t.elapsed+(e.val()-t.serverTime),isRunning:!1,serverTime:firebase.database.ServerValue.TIMESTAMP})})},this.appendChild(e),this.appendChild(n),this.appendChild(r),this.appendChild(s),a(),document.addEventListener("tr-layout",function(e){if(!e.detail)return;const r=e.detail[t.property];if(!r)return t.isRunning=!1,t.elapsed=0,t.serverTime=0,void a();t.isRunning=r.isRunning,t.elapsed=r.elapsed,t.serverTime=r.serverTime,a()})}}customElements.define("tr-button-timer",t)}(),function(){class t extends HTMLElement{constructor(){super()}get view(){return this.getAttribute("view")}get title(){return this.getAttribute("title")}connectedCallback(){const t=this,e=document.createElement("button");e.textContent=this.title,e.onclick=function(){Tracker.openView(t.view)},this.appendChild(e);var r=function(n){Tracker.getCurrentView()===t.view&&e.classList.add("active"),document.removeEventListener("tr-layout",r)};document.addEventListener("tr-layout",r)}}customElements.define("tr-button-view",t)}(),function(){class t extends HTMLElement{constructor(){super()}get toggle_class(){return this.getAttribute("toggle-class")}get targets(){return document.querySelectorAll(this.getAttribute("target"))}connectedCallback(){const t=this;var e=function(){var e=0,r=0;t.targets.length?(r=t.targets.length,t.targets.forEach(t=>{t.textContent.trim().length>0&&(e+=1)})):(r=1,e=t.textContent.trim().length>0),e===r?t.classList.add(t.toggle_class):t.classList.remove(t.toggle_class)},r=new MutationObserver(function(t){t.forEach(function(t){e()})}),n={characterData:!0,subtree:!0,childList:!0};t.targets.length?t.targets.forEach(t=>{r.observe(t,n)}):r.observe(t,n),setTimeout(e,1)}}customElements.define("tr-class-if-full",t)}(),function(){class t extends HTMLElement{constructor(){super()}get toggle_class(){return this.getAttribute("toggle-class")}get targets(){return document.querySelectorAll(this.getAttribute("target"))}connectedCallback(){const t=this;var e=function(){var e=0;t.targets.length?t.targets.forEach(t=>{e+=t.textContent.trim().length}):e=t.textContent.trim().length,0==e?t.toggle_class?t.classList.add(t.toggle_class):t.style.display="none":t.toggle_class?t.classList.remove(t.toggle_class):t.style.display="initial"},r=new MutationObserver(function(t){t.forEach(function(t){e()})}),n={characterData:!0,subtree:!0,childList:!0};t.targets.length?t.targets.forEach(t=>{r.observe(t,n)}):r.observe(t,n),setTimeout(e,1)}}customElements.define("tr-hide-if-empty",t)}(),function(){class t extends HTMLElement{constructor(){super(),this.image=null,this.options=[],this.dialog=null,this.listener=null,this.initialIndex=-1}get property(){return Tracker.getPropertyAttribute(this)}showOptions(){if(this.dialog)return;document.querySelectorAll("tr-image").forEach(function(t){t!==this&&t.closeOptions(t)});const t=this;this.dialog=document.createElement("div"),this.dialog.classList.add("dialog"),this.dialog.style.position="absolute",this.dialog.id=this.property,this.options.forEach(function(e,r){var n=document.createElement("figure"),s=document.createElement("img");s.onerror=function(){s.style.display="none"},s.src=e.getAttribute("path"),s.setAttribute("value",r),s.className=e.className;var i=e.getAttribute("dialog-img-class");if(i&&(-1!==i.indexOf(" ")?i.split(" ").forEach(function(t){s.classList.add(t)}):s.classList.add(i)),s.onclick=function(e){e.stopPropagation(),t.closeOptions(t),Tracker.updateLayoutMultiple([{property:t.property,value:s.getAttribute("value")},{property:Tracker.getLabelPropertyName(t.property),value:s.getAttribute("label")}])},n.appendChild(s),e.getAttribute("label")){s.setAttribute("label",e.getAttribute("label"));var a=document.createElement("figcaption");a.textContent=s.getAttribute("label"),n.appendChild(a)}t.dialog.appendChild(n)});var e=this.getBoundingClientRect();this.dialog.style.left=e.right+(window.pageXOffset||document.documentElement.scrollLeft)-(document.documentElement.clientLeft||0)+"px",this.dialog.style.top=e.bottom+(window.pageYOffset||document.documentElement.scrollTop)-(document.documentElement.clientTop||0)+"px",this.listener=function(){t.closeOptions(t)},document.addEventListener("click",this.listener),document.body.appendChild(this.dialog)}closeOptions(t){t.dialog&&(document.body.removeChild(t.dialog),t.dialog=null),t.listener&&(document.removeEventListener("click",t.listener),t.listener=null)}connectedCallback(){var t=function(){e.options.forEach(function(t){var r=t.getAttribute("img-class");r&&(-1!==r.indexOf(" ")?r.split(" ").forEach(function(t){e.image.classList.remove(t)}):e.image.classList.remove(r))})};const e=this;this.options=this.querySelectorAll("tr-image-option"),this.image=document.createElement("img"),this.appendChild(this.image),this.initialized=!1,this.options.forEach(function(t){var e=document.createElement("img");e.src=t.getAttribute("path"),e.style.display="none",e.onload=function(){document.body.removeChild(this)},document.body.appendChild(e)}),this.image.onerror=function(){this.style.display="none"};var r=function(t){var e=document.createElement("a");return e.href=t,e.href};-1===e.initialIndex&&(e.initialIndex=Array.prototype.slice.call(e.options).findIndex(function(t){return t.hasAttribute("selected")})),-1===e.initialIndex&&(e.initialIndex=0),document.addEventListener("tr-layout",function(n){var s;if(n.detail&&(s=n.detail[e.property],void 0===s&&(e.options.length>0&&!1===e.initialized&&(setTimeout(function(){Tracker.updateLayoutMultiple([{property:Tracker.getLabelPropertyName(e.property),value:e.options[0].getAttribute("label")}])},1),t(),e.initialized=!0),s=e.initialIndex)),0===e.options.length)r(s)!==e.image.src&&(e.image.style.display="initial",e.image.src=s);else{e.options.forEach(function(t){t.removeAttribute("selected")});var i=e.options[Number(s)];if(i){e.image.style.display="initial",e.image.src=i.getAttribute("path"),i.setAttribute("selected","selected"),t();var a=i.getAttribute("img-class");a&&(-1!==a.indexOf(" ")?a.split(" ").forEach(function(t){e.image.classList.add(t)}):e.image.classList.add(a))}}}),document.addEventListener("tr-reset",function(t){e.initialized=!1}),0!==this.options.length&&(e.onclick=function(t){t.stopPropagation(),e.showOptions()})}}customElements.define("tr-image",t)}(),function(){class t extends HTMLElement{constructor(){super(),this.image=null,this._value=!1}get property(){return Tracker.getPropertyAttribute(this)}get src(){return this.getAttribute("src")}get value(){return this._value}set value(t){t?this.image.classList.add(this.class):this.image.classList.remove(this.class),this._value=t}get class(){return this.getAttribute("class")}connectedCallback(){const t=this;this.image=document.createElement("img"),this.image.src=this.src,this.appendChild(this.image),this.image.onerror=function(){this.style.display="none"},document.addEventListener("tr-layout",function(e){e.detail&&(t.value=1==e.detail[t.property])}),t.onclick=function(e){Tracker.updateLayout(t.property,!t.value)}}}customElements.define("tr-image-toggle",t)}(),function(){class t extends HTMLElement{constructor(){super()}get property(){return Tracker.getPropertyAttribute(this)}get oninput(){return this.hasAttribute("oninput")}get value(){return this.getAttribute("value")}get max(){return this.getAttribute("max")}get min(){return this.getAttribute("min")}connectedCallback(){const t=this;t.innerHTML="<input type='number'/>";const e=t.childNodes[0];var r=function(){Tracker.updateLayout(t.property,e.value)};this.oninput?e.oninput=r:e.onblur=r,e.setAttribute("min",this.min),e.setAttribute("max",this.max),document.addEventListener("tr-layout",function(n){if(n.detail){var s=n.detail[t.property],i=!1;s||(s=t.value,i=!0,s)?(e.value=s,i&&setTimeout(r,1)):e.value=""}})}}customElements.define("tr-input-number",t)}(),function(){document.currentScript.ownerDocument;class t extends HTMLElement{constructor(){super()}get property(){return Tracker.getPropertyAttribute(this)}get value(){return this.getAttribute("value")}get checked(){return this.hasAttribute("checked")}connectedCallback(){const t=this;this.input=document.createElement("input");var e=function(){Tracker.updateLayoutMultiple([{property:t.property,value:t.value},{property:Tracker.getLabelPropertyName(t.property),value:t.getAttribute("label")}])};this.input.type="radio",this.input.value=this.value,this.input.id=this.id,this.id="",this.input.onchange=function(t){t.stopPropagation(),e()},this.appendChild(this.input),document.addEventListener("tr-layout",function(r){var n;if(r.detail&&(n=r.detail[t.property]),void 0===n&&t.checked)return t.input.name=t.property,void setTimeout(e,1);if(void 0!==n&&n==t.value?(t.input.setAttribute("checked",!0),t.input.checked=!0):(t.input.removeAttribute("checked"),t.input.checked=!1),t.hasAttribute("target")&&t.hasAttribute("toggle-class")){var s=document.querySelectorAll(t.getAttribute("target"));s.forEach(function(e){t.input.checked?e.classList.add(t.getAttribute("toggle-class")):e.classList.remove(t.getAttribute("toggle-class"))})}})}}customElements.define("tr-input-radio",t)}(),function(){class t extends HTMLElement{constructor(){super()}get property(){return Tracker.getPropertyAttribute(this)}get oninput(){return this.hasAttribute("oninput")}get list(){return this.hasAttribute("list")}get listValue(){return this.getAttribute("list")}connectedCallback(){const t=this;t.innerHTML="<input type='text' placeholder=' '/>";const e=t.childNodes[0];var r=function(){Tracker.updateLayout(t.property,e.value)};this.list&&(e.classList.add("awesomplete"),e.setAttribute("list",this.listValue)),this.oninput?e.oninput=r:e.onblur=r,document.addEventListener("tr-layout",function(r){if(!r.detail)return;const n=r.detail[t.property];e.value=n||""})}}customElements.define("tr-input-text",t)}(),function(){class t extends HTMLElement{constructor(){super()}get property(){return Tracker.getPropertyAttribute(this)}get oninput(){return this.hasAttribute("oninput")}get rows(){return this.getAttribute("rows")}get cols(){return this.getAttribute("cols")}connectedCallback(){const t=this;t.innerHTML="<textarea placeholder=' '/>";const e=t.childNodes[0];e.setAttribute("rows",t.rows),e.setAttribute("cols",t.cols);var r=function(){Tracker.updateLayout(t.property,e.value)};this.oninput?e.oninput=r:e.onblur=r,document.addEventListener("tr-layout",function(r){if(!r.detail)return;const n=r.detail[t.property];e.value=n||""})}}customElements.define("tr-input-textarea",t)}(),function(){class t extends HTMLElement{constructor(){super(),this.lastUpdate=0,this.isRunning=!1,this.elapsed=0,this.serverTime=0,this.input=null}get property(){return Tracker.getPropertyAttribute(this)}get value(){return this.input.value}connectedCallback(){const t=this;t.innerHTML="<input type='text'/>",this.input=t.childNodes[0];var e=function(){var e=Tracker.parseMS(t.elapsed);t.input.value=Tracker.dateToText(e,!1)},r=function(){if(!1!==t.isRunning){var r=new Date;t.elapsed+=r-t.lastUpdate,t.lastUpdate=r,e()}};setInterval(r,50),document.addEventListener("tr-layout",function(r){if(!r.detail)return;const n=r.detail[t.property];if(!n)return t.lastUpdate=0,t.isRunning=!1,t.elapsed=0,t.serverTime=0,void e();t.lastUpdate=new Date,t.isRunning=n.isRunning,t.isRunning?t.elapsed=n.elapsed+(r.detail.__now__-n.serverTime):t.elapsed=n.elapsed,t.serverTime=n.serverTime,e()})}}customElements.define("tr-input-timer",t)}(),function(){class t extends HTMLElement{constructor(){super()}get property(){return Tracker.getPropertyAttribute(this)}connectedCallback(){const t=this,e=document.createElement("input");e.type="checkbox",t.id&&(e.id=t.id,t.removeAttribute("id")),t.appendChild(e),e.onchange=function(){Tracker.updateLayout(t.property,e.checked)},document.addEventListener("tr-layout",function(r){var n=!1;r.detail&&(n=r.detail[t.property],void 0===n&&(n=t.hasAttribute("checked")||!1)),e.checked!=n&&(e.checked=n,e.onchange())})}}customElements.define("tr-input-toggle",t)}(),function(){class t extends HTMLElement{constructor(){super(),this.initialDisplay=this.style.display}get property(){return Tracker.getPropertyAttribute(this)}get targets(){return document.querySelectorAll(this.getAttribute("target"))}get toggle_class(){return this.getAttribute("toggle-class")}connectedCallback(){const t=this,e=document.createElement("input");e.type="checkbox",t.id&&(e.id=t.id,t.removeAttribute("id")),t.appendChild(e),e.onchange=function(){Tracker.updateLayout(t.property,e.checked)},document.addEventListener("tr-layout",function(r){var n=!1;r.detail&&(n=r.detail[t.property],void 0===n&&(n=t.hasAttribute("checked")||!1)),e.checked!=n&&(e.checked=n,e.onchange()),t.targets.forEach(function(e){n?e.classList.add(t.toggle_class):e.classList.remove(t.toggle_class)})})}}customElements.define("tr-input-toggle-class",t)}(),function(){class t extends HTMLElement{constructor(){super()}get property(){return Tracker.getLabelPropertyName(Tracker.getPropertyAttribute(this))}connectedCallback(){const t=this;document.addEventListener("tr-layout",function(e){if(t.textContent="",!e.detail)return;const r=e.detail[t.property];r&&(t.textContent=r)})}}customElements.define("tr-label",t)}(),function(){class t extends HTMLElement{constructor(){super(),this.options=[],this.select=null}get property(){return Tracker.getPropertyAttribute(this)}get size(){return this.hasAttribute("size")}get sizeValue(){return this.getAttribute("size")}connectedCallback(){const t=this;this.select=document.createElement("select"),this.options=this.querySelectorAll("tr-option"),this.options.forEach(function(e,r){var n=document.createElement("option");n.textContent=e.textContent,n.setAttribute("value",e.getAttribute("value")),n.textContent||(n.textContent=e.getAttribute("value")),e.hasAttribute("selected")&&(n.selected=!0),t.select.appendChild(n),e.style.display="none"}),this.appendChild(this.select);var e=function(){Tracker.updateLayoutMultiple([{property:t.property,value:t.select.value},{property:Tracker.getLabelPropertyName(t.property),value:t.options[t.select.selectedIndex].getAttribute("label")}])};this.select.onchange=function(t){t.stopPropagation(),e()},this.hasAttribute("disabled")&&this.select.setAttribute("disabled","disabled"),this.size&&this.select.setAttribute("size",t.sizeValue),document.addEventListener("tr-layout",function(r){var n;if(r.detail&&(n=r.detail[t.property]),void 0===n){var s=Array.prototype.slice.call(t.options).findIndex(function(t){return t.hasAttribute("selected")});return-1===s&&(s=0),t.select.selectedIndex=s,void setTimeout(e,1)}t.select.value=n,t.options.forEach(function(e){if(e.hasAttribute("target")&&e.hasAttribute("toggle-class")){var r=document.querySelectorAll(e.getAttribute("target"));r.forEach(function(r){e.getAttribute("value")===t.select.value?r.classList.add(e.getAttribute("toggle-class")):r.classList.remove(e.getAttribute("toggle-class"))})}})})}}customElements.define("tr-select",t)}(),function(){class t extends HTMLElement{constructor(){super(),this.options=[],this.select=null}get property(){return Tracker.getPropertyAttribute(this)}connectedCallback(){const t=this;var e=function(e){return e.hasAttribute("player")?Tracker.getPropertyAttribute(e,t.property):e.getAttribute("value")};this.select=document.createElement("select"),this.options=this.querySelectorAll("tr-option"),this.options.forEach(function(e,r){var n=document.createElement("option");n.textContent=e.textContent,n.setAttribute("value",e.getAttribute("value")),n.textContent||(n.textContent=e.getAttribute("value")),e.hasAttribute("selected")&&(n.selected=!0),t.select.appendChild(n),e.style.display="none"}),this.appendChild(this.select);var r=function(){var r=[];t.options.forEach(function(n,s){var i={};i.property=e(n),n.getAttribute("value")==t.select.value?i.value=!0:i.value=!1,r.push(i)}),Tracker.updateLayoutMultiple(r)};this.select.onchange=function(t){t.stopPropagation(),r()},document.addEventListener("tr-layout",function(n){var s=!1;if(t.options.forEach(function(r){var i=!1;if(n.detail&&(i=n.detail[e(r)]||!1),r.hasAttribute("target")&&r.hasAttribute("toggle-class")){var a=document.querySelectorAll(r.getAttribute("target"));a.forEach(function(t){i?t.classList.add(r.getAttribute("toggle-class")):t.classList.remove(r.getAttribute("toggle-class"))})}i&&(t.select.value=r.getAttribute("value"),s=!0)}),!s){var i=Array.prototype.slice.call(t.options).findIndex(function(t){return t.hasAttribute("selected")});-1===i&&(i=0),t.select.selectedIndex=i,setTimeout(r,1)}})}}customElements.define("tr-select-toggle",t)}(),function(){class t extends HTMLElement{constructor(){super()}get source(){return this.getAttribute("source")}get href(){return this.getAttribute("href")}connectedCallback(){const t=this;if(this.href){var e=new XMLHttpRequest;e.open("GET",this.href,!0),e.onload=function(r){4===e.readyState&&(200===e.status?t.innerHTML=e.responseText:console.log(e.statusText))},e.onerror=function(t){console.log(e.statusText)},e.send()}else{var r=document.querySelector(this.source).content;this.appendChild(document.importNode(r,!0))}}}customElements.define("tr-template",t)}(),function(){class t extends HTMLElement{constructor(){super(),this.goalWidth=0}get property(){return Tracker.getPropertyAttribute(this)}get scaleToFitX(){return this.hasAttribute("scale-to-fit-x")}connectedCallback(){const t=this;if(this.goalWidth=this.offsetWidth,document.addEventListener("tr-layout",function(e){if(t.textContent="",!e.detail)return;const r=e.detail[t.property];t.textContent=r||""}),t.scaleToFitX){var e=new MutationObserver(function(e){var r=e[0],n=r.target;"#text"===n.nodeName&&(n=n.parentNode);var s=n.style.transform;-1!==s.indexOf("scaleX")&&(s=s.replace(/scaleX\(.*?\) */g,""));var i=t.offsetWidth;if(n.scrollWidth>i){var a=i/n.scrollWidth;s+=" scaleX("+a+") "}else s+=" scaleX(1) ";n.style.transform=s,n.style.transformOrigin="left"});e.observe(this,{childList:!0,characterData:!0,subtree:!0})}}}customElements.define("tr-text",t)}(),function(){class t extends HTMLElement{constructor(){super(),this.lastUpdate=0,this.isRunning=!1,this.elapsed=0,this.serverTime=0}get property(){return Tracker.getPropertyAttribute(this)}get includePadding(){return this.getAttribute("include-padding")}get targets(){return document.querySelectorAll(this.getAttribute("target"))}get toggle_class(){return this.getAttribute("toggle-class")}connectedCallback(){const t=this;var e=function(){var e=Tracker.parseMS(t.elapsed);t.innerHTML=Tracker.dateToTags(e,t.includePadding),t.isRunning?t.setAttribute("running",!0):t.removeAttribute("running"),t.targets.forEach(function(e){t.isRunning?e.classList.add(t.toggle_class):e.classList.remove(t.toggle_class)})},r=function(){if(!1!==t.isRunning){var r=new Date;t.elapsed+=r-t.lastUpdate,t.lastUpdate=r,e()}};setInterval(r,50),document.addEventListener("tr-layout",function(r){if(!r.detail)return;const n=r.detail[t.property];if(!n)return t.lastUpdate=0,t.isRunning=!1,t.elapsed=0,t.serverTime=0,void e();t.lastUpdate=new Date,t.isRunning=n.isRunning,t.isRunning?t.elapsed=n.elapsed+(r.detail.__now__-n.serverTime):t.elapsed=n.elapsed,t.serverTime=n.serverTime,e()})}}customElements.define("tr-timer",t)}(),function(){class t extends HTMLElement{constructor(){super()}get property(){return Tracker.getTimestampPropertyName(Tracker.getPropertyAttribute(this))}connectedCallback(){const t=this;document.addEventListener("tr-layout",function(e){if(t.textContent="",!e.detail)return;const r=e.detail[t.property];r&&(t.textContent=r)})}}customElements.define("tr-timestamp",t)}(),function(){class t extends HTMLElement{constructor(){super(),this.initialDisplay=this.style.display}get property(){return Tracker.getPropertyAttribute(this)}connectedCallback(){const t=this;document.addEventListener("tr-layout",function(e){var r=!0;e.detail&&(r=e.detail[t.property],null===r&&(r=!0)),t.style.display=r?t.initialDisplay:"none"})}}customElements.define("tr-toggle",t)}(),function(){class t extends HTMLElement{constructor(){super()}get property(){return Tracker.getPropertyAttribute(this)}get toggle_class(){return this.getAttribute("toggle-class")}get value(){return this._value}set value(t){t?this.classList.add(this.toggle_class):this.classList.remove(this.toggle_class),this._value=t}connectedCallback(){const t=this;document.addEventListener("tr-layout",function(e){e.detail&&(t.value=1==e.detail[t.property])}),t.onclick=function(e){Tracker.updateLayout(t.property,!t.value)}}}customElements.define("tr-toggle-class",t)}(),function(){class r extends HTMLElement{constructor(){super()}get property(){return t()}get player(){return Number(this.getAttribute("player"))}get stage(){return e(this)-1}connectedCallback(){const t=this;document.addEventListener("tr-layout",function(e){if(t.textContent="",!e.detail)return;const r=e.detail[t.property];if(!r)return;if(!r[t.stage])return;let n=r[t.stage][t.player];if(!n)return;let s=n.elapsed;t.textContent=Tracker.dateToText(Tracker.parseMS(s))})}}customElements.define("tr-ds-timestamp",r)}(),function(){class r extends HTMLElement{constructor(){super()}get property(){return t()}get player(){return Number(this.getAttribute("player"))}get stage(){return e(this)-1}get negativeClass(){return Number(this.getAttribute("negative-class"))||"negative"}get positiveClass(){return Number(this.getAttribute("positive-class"))||"positive"}connectedCallback(){const t=this;document.addEventListener("tr-layout",function(e){if(t.textContent="",t.classList.remove(t.negativeClass),t.classList.remove(t.positiveClass),!e.detail)return;const r=e.detail[t.property];if(!r)return;if(!r[t.stage])return;let n=r[t.stage][t.player];if(!n)return;let s=n.diff;s&&(s<0?(t.classList.add(t.negativeClass),t.textContent=Tracker.dateToText(Tracker.parseMS(-s))):(t.classList.add(t.positiveClass),t.textContent=Tracker.dateToText(Tracker.parseMS(s))))})}}customElements.define("tr-ds-timediff",r)}(),function(){class e extends HTMLElement{constructor(){super(),this.isRunning=!1,this.elapsed=0,this.serverTime=0,this.stages=[]}get property(){return t()}get timerProperty(){return Tracker.getPropertyAttribute(null,this.getAttribute("timer"))}get player(){return Number(this.getAttribute("player"))}get opponent(){return Number(this.getAttribute("opponent"))}get adjustments(){return(this.getAttribute("adjustments")||"1,10").split(",")}connectedCallback(){const t=this;var e=function(e){var r=t.stages[e]||{};if(r[t.player]&&r[t.opponent]){let e=r[t.opponent].elapsed-r[t.player].elapsed;r[t.player].diff=-e,r[t.opponent].diff=e}t.stages[e]=r};this.adjustments.reverse().forEach(function(r){var n=document.createElement("button");n.textContent="-"+r+"s",n.classList.add("adjustment"),n.onclick=function(){let n=-1;for(let e=0;e<t.stages.length;e++)t.stages[e][t.player]&&(n=e);n>=0&&(t.stages[n][t.player].elapsed-=1e3*r),e(n),Tracker.updateLayout(t.property,t.stages)},t.appendChild(n)});const r=document.createElement("button"),n=document.createElement("button");r.innerHTML="Split",n.innerHTML="Reverse",r.classList.add("split"),n.classList.add("reverse"),r.onclick=function(){t.stages||(t.stages=[]),Tracker.getServerTime().then(function(r){let n=0;for(let e=0;e<t.stages.length;e++)t.stages[e][t.player]&&(n=e+1);t.stages[n]||(t.stages[n]={});let s=t.stages[n];s[t.player]={elapsed:t.elapsed+(r.val()-t.serverTime)},e(n),Tracker.updateLayout(t.property,t.stages)})},n.onclick=function(){let e=-1;for(let r=0;r<t.stages.length;r++)t.stages[r][t.player]&&(e=r);e>=0&&(t.stages[e][t.player]=null,t.stages[e][t.player]&&(t.stages[e][t.player].diff=null),t.stages[e][t.opponent]&&(t.stages[e][t.opponent].diff=null),Tracker.updateLayout(t.property,t.stages))},t.appendChild(r),t.appendChild(n),this.adjustments.forEach(function(r){var n=document.createElement("button");n.textContent="+"+r+"s",n.classList.add("adjustment"),n.onclick=function(){let n=-1;for(let e=0;e<t.stages.length;e++)t.stages[e][t.player]&&(n=e);n>=0&&(t.stages[n][t.player].elapsed+=1e3*r),e(n),Tracker.updateLayout(t.property,t.stages)},t.appendChild(n)}),document.addEventListener("tr-layout",function(e){if(!e.detail)return void(t.stages=[]);const r=e.detail[t.timerProperty];r?(t.isRunning=r.isRunning,t.elapsed=r.elapsed,t.serverTime=r.serverTime):(t.isRunning=!1,t.elapsed=0,t.serverTime=0);const n=e.detail[t.property];n&&(t.stages=n)}),document.addEventListener("tr-reset",function(e){t.stages=[],t.isRunning=!1,t.elapsed=0,t.serverTime=0,t.stages=[]})}}customElements.define("tr-ds-controls",e)}()})();